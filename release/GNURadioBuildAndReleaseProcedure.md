# GNU Radio Build and Runtime Dependencies
## Required Packages

|Key:                                     |
-------------------------------------------
|C: Conan based dep                       |
|CM: CMake based dep                      |
|P: python/pip based dep                  |
|S: system library, dont bundle or install|

| All platforms | |
----------------|-----------------|
| qt/5.15.11 | C |
| thrift/0.18.1 - built with Python | C |
| libsndfile/1.2.2 | C |
| fftw/3.3.10 | C |
| gsl/2.7.1 | C |
| sdl/2.28.5 | C |
| zeromq/4.3.5 | C |
| qwt/6.2.0 | C |
| gmp/6.3.0 | C |
| volk/1.3.268.0 | C |
| UHD | CM |
| OpenGL | S |
| portaudio | CM |
| GTK | C/CM |
| Mako | P |
| Cairo | P |
| numpy | P |
| scipy | P |
| pybind11.2.11.1 | C |
| SoapySDR | CM |

|Linux Only | |
------------|--
| ALSA | S |
| OSS | S |
| libunwind | S |
| libiio | S |
| libad9361 | S |

| Docs | |
----------|----
| Doxygen | C |

### Installer

Wix (install by hand, ensure candle and light come bundled)
NSIS (install by hand)
DragNDrop - available by default on MacOS
DMG - available by default on MacOS
Flatpak - install on Linux - experimental (works AFAICT)

## Building Notes for deps

### All CMake deps
From conan - conan toolchain is currently very broken, do not use
Instead for detection, add the conan generator directory to CMAKE_PREFIX_PATH on the command line

### libusb
Required by UHD
Driven by CMake script
MSBuild on Windows
Autotools on MacOS

> &#9432; **Note**
    **THIS MUST BE THE SAME RUNTIME AS GNU Radio + Boost ARE BUILT WITH**
    This should be accomplished by running CMake from the appropriate VSDev prompt

### Boost

Boost installed by Spack or Conan requires `"-DCMAKE_CXX_FLAGS=-DBOOST_ALL_NO_LIB /EHsc"` specified in consuming project.
`-DBOOST_ALL_NO_LIB` is utilized in order to link against non-version mangled boost libs (those built with )
> &#9432; **Note**
    This is not required if boost is built with this option
    Currently required with Spack + Conan built Boost

`/EHsc` is specified to allow for Boost's exception handling semantics. Otherwise boost will fail to link

Need to be careful of boost dyn lib arguments

Do not let CMake's vendored FindBoost.cmake be the module to detect Boost, it will find the headers installed by conan but not the libs. This results in somewhat confusing linker errors as `${Boost_LIBRARIES}` is defined empty so no boost libs are included in the linker line.

Ensure both conan and cmake are building 64bit release configuration to build GNURadio in same

Remember to specify Boost static libs argument (found in my CMake scripts for UHD)

### Python based deps

We're installing python based deps (make, cairo, scipy, numpy), etc
For each package that depends on one of these, you need to be sure
that the Python you "pip install" those py deps with is EXACTLY the same
python that GNURadio is finding during its CMake run
Otherwise there will be conflicts between GNU Radio, it's installed deps, and its
bundled runtime python deps

### General Build notes for deps

* CMake based builds need to be in release configuration to link against Conan targets
Spack can be in either configuration, so just be mindful about your variants

* Need to be sure conan profile compiler version matches msvc compiler version picked up by cmake

## CMake Variables of consideration for the Windows Wix installer

*CPACK_WIX_PRODUCT_GUID* - this is an identifier used by the installer + Windows to denote a a given installation. If this is the same value as an existing installation on the system the installer will error out indicating the software is already present. CPack will automatically generate this value, ensuring that each build of the installer has a unique GUID and can thus be re-installed.

It is recommended to not set ths variable and to allow CMake to generate it

*CPACK_WIX_UPGRADE_GUID* - this is an identifier used by Wix + Windows to identify an installer as an "upgrade" rather than a new package altogether (ensures old version is replaced). The value in this proect was generated by `guidgen` and should not be modified, otherwise the installer will be unable to properly replace previous installations

*CPACK_WIX_SHORTCUT_GUID* - This is not an official CPack variable but rather one created for the GNU Radio installer. It is used to allow the installer to identify previouslly created GRC start menu shortcuts and replace them on re-install.
This was generated by `guidgen` and should not be modified.



# Build notes and instructions for GNU Radio on Windows & MacOS

PCH and Boost
 - need to include boost headers in the pch compilation
 - or turn ENABLE_COMMON_PCH off


Thift support is fully broken on Windows. You can build without issue, but importing _anything_ related to GR will deadlock and hang.

Need to add numpy to include interface
-DPython_NumPy_INCLUDE_DIR=

The GTK bin directory should be set via the GTK_BIN_DIR variable on the CMake command line or in a CMake preset. If it is not set, GR will default to
the default GVS build location on Windows.
